<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Binyan Shalem | Empowering Homes</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts: Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- PDF Generation Libraries -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.23/jspdf-autotable.min.js"></script>
    
    <!-- Custom Tailwind Configuration -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'custom-deep-purple': '#723358', // rgba(114,51,88,1)
                        'custom-slate-gray': '#4B5562', // rgba(75, 85, 98, 1)
                        'custom-beige': '#BAA68E',      // rgba(186,166,142,1)
                    }
                }
            }
        }
    </script>

    <!-- Custom Styles -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; /* slate-50 */
            scroll-behavior: smooth;
        }
        .nav-link.active {
            font-weight: 700;
            color: white;
            background-color: rgba(186, 166, 142, 0.3);
        }
        #main-header.scrolled {
            background-color: white;
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        }
        #main-header.scrolled .nav-link:not(.donate-btn) {
            color: #4B5562;
        }
        #main-header.scrolled .nav-link.active:not(.donate-btn) {
            color: #723358;
            background-color: rgba(186, 166, 142, 0.2);
        }
        #main-header.scrolled .donate-btn {
            color: white !important;
        }
        #main-header.scrolled .header-text {
            color: #1f2937;
        }
        .form-section {
            transition: opacity 0.5s ease-in-out, max-height 0.5s ease-in-out;
            max-height: 0;
            opacity: 0;
            overflow: hidden;
        }
        .form-section.active {
            max-height: 2000px;
            opacity: 1;
        }
        .mandatory-star {
            color: #ef4444; /* red-500 */
            font-weight: bold;
            margin-left: 2px;
        }
    </style>
</head>
<body class="text-slate-800">

    <!-- Header -->
    <header id="main-header" class="fixed w-full top-0 z-50 transition-all duration-300">
        <div class="container mx-auto px-6 py-4 flex justify-between items-center">
            <div class="flex items-center space-x-3">
                <img src="https://www.binyan-shalem.com/Binyan%20Shalem_files/8594235c61f23b5d99cd2a2dbf37c8b5.jpg" alt="Binyan Shalem Logo" class="h-12 w-auto">
                <div class="header-text text-white">
                    <h1 class="text-xl font-bold tracking-tight">BINYAN SHALEM</h1>
                </div>
            </div>
            <nav class="hidden md:flex items-center space-x-2 text-white">
                <a href="#home" class="nav-link transition-colors px-3 py-2 rounded-md">Home</a>
                <a href="#mission" class="nav-link transition-colors px-3 py-2 rounded-md">Our Mission</a>
                <a href="#contact" class="nav-link transition-colors px-3 py-2 rounded-md">Get Help</a>
                <a href="donate.html" class="nav-link donate-btn bg-custom-deep-purple text-white px-4 py-2 rounded-lg hover:opacity-90 transition-all shadow ml-6">Donate</a>
            </nav>
            <button id="mobile-menu-button" class="md:hidden text-white focus:outline-none">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path></svg>
            </button>
        </div>
        <div id="mobile-menu" class="hidden md:hidden px-6 pb-4 bg-white/95 backdrop-blur-sm rounded-b-lg">
            <a href="#home" class="nav-link block py-2 text-slate-700">Home</a>
            <a href="#mission" class="nav-link block py-2 text-slate-700">Our Mission</a>
            <a href="#contact" class="nav-link block py-2 text-slate-700">Get Help</a>
            <a href="donate.html" class="nav-link donate-btn block mt-2 text-center bg-custom-deep-purple text-white px-4 py-2 rounded-lg shadow">Donate</a>
        </div>
    </header>

    <!-- Main Content -->
    <main>
        <section id="home" class="relative min-h-screen flex items-center justify-center text-center text-white bg-cover bg-center bg-fixed" style="background-image: url('https://raw.githubusercontent.com/BinyanShalem/ShalemBinyan/refs/heads/main/gametime.png')">
            <div class="absolute inset-0 bg-black opacity-40"></div>
            <div class="relative z-10 container mx-auto px-6">
                <h2 class="text-4xl md:text-6xl font-bold leading-tight mb-4">Empowering Homes within a Torah Framework.</h2>
                <p class="text-lg md:text-2xl text-slate-200 max-w-3xl mx-auto mb-8">
                    Our goal is to provide couples with personalized, practical support within the framework of rabbinical guidance to help you build a stronger, more fulfilling marriageâ€”at no cost to you.
                </p>
                <div>
                    <a href="#contact" class="bg-custom-deep-purple text-white px-8 py-3 rounded-lg hover:opacity-90 transition-opacity text-lg font-semibold shadow-lg">Your journey starts here</a>
                </div>
            </div>
        </section>

        <div class="relative z-20 bg-slate-50">
            <section id="mission" class="py-28 md:py-40 bg-custom-beige">
                <div class="container mx-auto px-6">
                    <div class="text-center mb-16">
                        <h3 class="text-3xl md:text-4xl font-bold text-slate-900">Guidance You Can Trust</h3>
                        <p class="text-lg text-slate-600 mt-2">Our approach is built on three core principles.</p>
                    </div>
                    <div class="grid md:grid-cols-3 gap-10">
                        <div class="bg-white p-8 rounded-xl shadow-lg border border-slate-200 text-center">
                            <h4 class="text-2xl font-bold text-custom-deep-purple mb-4">1. Our Mission</h4>
                            <p class="text-slate-600">We recognize the common pitfalls of generic marriage advice. We aim to help Jewish couples strengthen their marriages by offering expert guidance, support, and tools tailored to their unique needs.</p>
                        </div>
                        <div class="bg-white p-8 rounded-xl shadow-lg border border-slate-200 text-center">
                            <h4 class="text-2xl font-bold text-custom-deep-purple mb-4">2. Tailored Support</h4>
                            <p class="text-slate-600">Rabbi Shaul Haber meets with couples, offering thoughtful, practical direction rooted in Torah values. We partner with a wide network of trusted professionals to ensure the highest level of care.</p>
                        </div>
                        <div class="bg-white p-8 rounded-xl shadow-lg border border-slate-200 text-center">
                            <h4 class="text-2xl font-bold text-custom-deep-purple mb-4">3. Absolute Confidentiality</h4>
                            <p class="text-slate-600">We prioritize your privacy above all else. Our services are built on a foundation of 100% confidentiality, ensuring a safe and secure space to work through challenges without fear of judgment.</p>
                        </div>
                    </div>
                </div>
            </section>

            <section id="contact" class="bg-white py-20 md:py-28">
                <div class="container mx-auto px-6">
                    <div class="max-w-2xl mx-auto text-center">
                        <h3 class="text-3xl md:text-4xl font-bold text-slate-900">Take the First Step</h3>
                        <p class="text-lg text-slate-600 mt-3 mb-8">Reach out through the secure form below. All submissions are seen only by Rabbi Shaul Haber and are completely confidential.</p>
                    </div>
                    <div class="max-w-lg mx-auto bg-white p-8 rounded-xl shadow-2xl border border-slate-200">
                        <form id="contact-form" novalidate>
                            <!-- Step 1: Initial Info -->
                            <div id="step-1">
                                <div class="mb-6">
                                    <label for="email" class="block text-sm font-medium text-slate-700 mb-2">Email<span class="mandatory-star">*</span></label>
                                    <input type="email" id="email" name="email" required class="w-full px-4 py-2 border border-slate-300 rounded-lg">
                                </div>
                                <div class="mb-6">
                                    <label class="block text-sm font-medium text-slate-700 mb-2">Who is submitting this form?<span class="mandatory-star">*</span></label>
                                    <div class="space-y-2">
                                        <div class="flex items-center"><input type="radio" id="husband-wife" name="submitter" value="Husband/Wife" class="h-4 w-4 text-custom-deep-purple"><label for="husband-wife" class="ml-3 block text-sm text-slate-800">Husband / Wife</label></div>
                                        <div class="flex items-center"><input type="radio" id="someone-else" name="submitter" value="Someone else" class="h-4 w-4 text-custom-deep-purple"><label for="someone-else" class="ml-3 block text-sm text-slate-800">Someone else</label></div>
                                    </div>
                                </div>
                            </div>

                            <!-- Step 2: Conditional Questions -->
                            <div id="relationship-step" class="form-section">
                                <hr class="my-6 border-slate-200">
                                <div class="mb-6">
                                    <label for="relationship" class="block text-sm font-medium text-slate-700 mb-2">What is your relationship to the couple?<span class="mandatory-star">*</span></label>
                                    <input type="text" id="relationship" name="relationship" class="w-full px-4 py-2 border border-slate-300 rounded-lg">
                                </div>
                            </div>

                            <div id="couple-details-form" class="form-section">
                                <hr class="my-6 border-slate-200">
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-6">
                                    <div><label for="husband_name" class="block text-sm font-medium text-slate-700 mb-1">Husband (First and Last)<span class="mandatory-star">*</span></label><input type="text" id="husband_name" name="husband_name" class="w-full px-4 py-2 border border-slate-300 rounded-lg"></div>
                                    <div><label for="wife_name" class="block text-sm font-medium text-slate-700 mb-1">Wife (First and Maiden)<span class="mandatory-star">*</span></label><input type="text" id="wife_name" name="wife_name" class="w-full px-4 py-2 border border-slate-300 rounded-lg"></div>
                                    <div><label for="husband_cell" class="block text-sm font-medium text-slate-700 mb-1">Husband Cell<span class="mandatory-star" id="husband_cell_star">*</span></label><input type="tel" id="husband_cell" name="husband_cell" class="w-full px-4 py-2 border border-slate-300 rounded-lg"></div>
                                    <div><label for="husband_email" class="block text-sm font-medium text-slate-700 mb-1">Husband Email</label><input type="email" id="husband_email" name="husband_email" class="w-full px-4 py-2 border border-slate-300 rounded-lg"></div>
                                    <div><label for="wife_cell" class="block text-sm font-medium text-slate-700 mb-1">Wife Cell<span class="mandatory-star" id="wife_cell_star">*</span></label><input type="tel" id="wife_cell" name="wife_cell" class="w-full px-4 py-2 border border-slate-300 rounded-lg"></div>
                                    <div><label for="wife_email" class="block text-sm font-medium text-slate-700 mb-1">Wife Email</label><input type="email" id="wife_email" name="wife_email" class="w-full px-4 py-2 border border-slate-300 rounded-lg"></div>
                                    <div><label for="husband_age" class="block text-sm font-medium text-slate-700 mb-1">Husband Age<span class="mandatory-star" id="husband_age_star">*</span></label><input type="text" id="husband_age" name="husband_age" class="w-full px-4 py-2 border border-slate-300 rounded-lg"></div>
                                    <div><label for="wife_age" class="block text-sm font-medium text-slate-700 mb-1">Wife Age<span class="mandatory-star" id="wife_age_star">*</span></label><input type="text" id="wife_age" name="wife_age" class="w-full px-4 py-2 border border-slate-300 rounded-lg"></div>
                                    <div class="md:col-span-2"><label for="address" class="block text-sm font-medium text-slate-700 mb-1">Address<span class="mandatory-star" id="address_star">*</span></label><textarea id="address" name="address" rows="3" class="w-full px-4 py-2 border border-slate-300 rounded-lg"></textarea></div>
                                    <div class="md:col-span-2"><label for="years_married" class="block text-sm font-medium text-slate-700 mb-1">How many years married?<span class="mandatory-star" id="years_married_star">*</span></label><input type="text" id="years_married" name="years_married" class="w-full px-4 py-2 border border-slate-300 rounded-lg"></div>
                                    <div class="md:col-span-2"><label for="issue" class="block text-sm font-medium text-slate-700 mb-1">Issue Presenting<span class="mandatory-star">*</span></label><textarea id="issue" name="issue" required rows="4" class="w-full px-4 py-2 border border-slate-300 rounded-lg"></textarea></div>
                                    <div><label for="family_rabbi" class="block text-sm font-medium text-slate-700 mb-1">Family Rabbi</label><input type="text" id="family_rabbi" name="family_rabbi" class="w-full px-4 py-2 border border-slate-300 rounded-lg"></div>
                                    <div><label for="kids_count" class="block text-sm font-medium text-slate-700 mb-1">How many kids?<span class="mandatory-star" id="kids_count_star">*</span></label><input type="text" id="kids_count" name="kids_count" class="w-full px-4 py-2 border border-slate-300 rounded-lg"></div>
                                    <div class="md:col-span-2"><label for="involved_parties" class="block text-sm font-medium text-slate-700 mb-1">Anyone else involved</label><input type="text" id="involved_parties" name="involved_parties" class="w-full px-4 py-2 border border-slate-300 rounded-lg"></div>
                                    <div class="md:col-span-2"><label for="parents_names" class="block text-sm font-medium text-slate-700 mb-1">Husband & Wife's parents names<span class="mandatory-star" id="parents_names_star">*</span></label><input type="text" id="parents_names" name="parents_names" class="w-full px-4 py-2 border border-slate-300 rounded-lg"></div>
                                </div>
                                <div class="mt-8">
                                    <button type="submit" class="w-full bg-custom-deep-purple text-white px-6 py-3 rounded-lg hover:opacity-90 transition-opacity text-lg font-semibold shadow-md">
                                        Save and Generate PDF
                                    </button>
                                </div>
                            </div>
                        </form>
                        <div id="form-success-message" class="hidden mt-6 text-center p-4 bg-green-100 text-green-800 rounded-lg">
                            Thank you! Your submission PDF has been downloaded.
                        </div>
                    </div>
                </div>
            </section>

            <section id="donate" class="py-20 md:py-28">
                <div class="container mx-auto px-6 text-center">
                    <h3 class="text-3xl md:text-4xl font-bold text-slate-900">Support Our Mission</h3>
                    <p class="text-lg text-slate-600 max-w-2xl mx-auto mt-4 mb-8">
                        Your generous contribution allows us to continue offering our services free of charge.
                    </p>
                    <a href="donate.html" class="bg-custom-deep-purple text-white px-10 py-4 rounded-lg hover:opacity-90 transition-opacity text-xl font-bold shadow-lg">
                        Click Here to Donate
                    </a>
                </div>
            </section>
        </div>
    </main>

    <footer class="bg-custom-slate-gray text-slate-300 relative z-20">
        <div class="container mx-auto px-6 py-8 text-center">
            <p>&copy; 2025 Binyan Shalem. All Rights Reserved.</p>
            <p class="text-sm text-slate-400 mt-2">A dedicated resource for building stronger Jewish homes.</p>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- Basic Page Setup ---
            const header = document.getElementById('main-header');
            const mobileMenuButton = document.getElementById('mobile-menu-button');
            const mobileMenu = document.getElementById('mobile-menu');

            window.addEventListener('scroll', () => {
                header.classList.toggle('scrolled', window.scrollY > 50);
            });

            mobileMenuButton.addEventListener('click', () => {
                mobileMenu.classList.toggle('hidden');
            });

            document.querySelectorAll('#mobile-menu a, #main-header nav a').forEach(link => {
                link.addEventListener('click', () => {
                    if (!mobileMenu.classList.contains('hidden')) {
                       mobileMenu.classList.add('hidden');
                    }
                });
            });

            // --- Active Nav Link on Scroll ---
            const sections = document.querySelectorAll('main section');
            const navLinks = document.querySelectorAll('.nav-link');
            document.querySelector('.nav-link[href="#home"]').classList.add('active');

            const sectionObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const id = entry.target.getAttribute('id');
                        navLinks.forEach(link => link.classList.remove('active'));
                        document.querySelector(`.nav-link[href="#${id}"]`)?.classList.add('active');
                    }
                });
            }, { rootMargin: "-30% 0px -60% 0px" });

            sections.forEach(section => sectionObserver.observe(section));
            
            // --- Multi-step Form Logic ---
            const contactForm = document.getElementById('contact-form');
            const relationshipStep = document.getElementById('relationship-step');
            const coupleDetailsForm = document.getElementById('couple-details-form');
            
            const mandatoryForHusbandWife = ['husband_cell', 'wife_cell', 'husband_age', 'wife_age', 'address', 'years_married', 'kids_count', 'parents_names'];
            const mandatoryForSomeoneElse = ['issue'];

            function setRequiredFields(submitterType) {
                const allFields = [...mandatoryForHusbandWife, ...mandatoryForSomeoneElse, 'husband_name', 'wife_name', 'relationship', 'issue'];
                
                allFields.forEach(id => {
                    const el = document.getElementById(id);
                    if(el) {
                        el.required = false;
                        const star = document.getElementById(`${id}_star`);
                        if (star) star.style.display = 'none';
                    }
                });
                
                if (submitterType === 'Husband/Wife') {
                    [...mandatoryForHusbandWife, 'husband_name', 'wife_name', 'issue'].forEach(id => {
                        const el = document.getElementById(id);
                        if (el) el.required = true;
                        const star = document.getElementById(`${id}_star`);
                        if (star) star.style.display = 'inline';
                    });
                } else if (submitterType === 'Someone else') {
                    ['relationship', 'husband_name', 'wife_name', 'issue'].forEach(id => {
                        const el = document.getElementById(id);
                        if (el) el.required = true;
                    });
                }
            }
            
            contactForm.elements.submitter.forEach(radio => {
                radio.addEventListener('change', (event) => {
                    const value = event.target.value;
                    coupleDetailsForm.classList.add('active');
                    if (value === 'Someone else') {
                        relationshipStep.classList.add('active');
                    } else {
                        relationshipStep.classList.remove('active');
                    }
                    setRequiredFields(value);
                });
            });

            // --- PDF Generation on Submit ---
            const successMessage = document.getElementById('form-success-message');
            contactForm.addEventListener('submit', function(e) {
                e.preventDefault();
                if (!contactForm.checkValidity()) {
                    contactForm.reportValidity();
                    return;
                }

                try {
                    const { jsPDF } = window.jspdf;
                    const doc = new jsPDF();

                    const formData = new FormData(contactForm);
                    const husbandName = formData.get('husband_name') || 'Unknown';
                    const wifeName = formData.get('wife_name') || 'Unknown';
                    const pdfTitle = `Binyan Shalem Intake - ${husbandName} & ${wifeName}`;
                    const fileName = `Intake - ${husbandName} - ${wifeName}.pdf`;

                    doc.setFontSize(18);
                    doc.text(pdfTitle, 14, 22);
                    doc.setFontSize(11);
                    doc.setTextColor(100);
                    doc.text(`Submission Date: ${new Date().toLocaleDateString()}`, 14, 30);
                    
                    const tableData = [];
                    const headers = [['Field', 'Response']];
                    
                    for (const [key, value] of formData.entries()) {
                        if (value) {
                            const label = document.querySelector(`label[for=${key}]`)?.textContent.replace('*','').trim() || key;
                            tableData.push([label, value]);
                        }
                    }
                    
                    // Use the autoTable method directly from the jspdf object
                    window.jspdf.autoTable(doc, {
                        head: headers,
                        body: tableData,
                        startY: 40,
                        theme: 'grid',
                        headStyles: { fillColor: [114, 51, 88] }, // custom-deep-purple
                    });
                    
                    doc.save(fileName);
                    
                    contactForm.style.display = 'none';
                    successMessage.classList.remove('hidden');
                } catch (error) {
                    console.error("Failed to generate PDF:", error);
                    alert("Sorry, there was an error generating the PDF. Please try again or contact support.");
                }
            });
        });
    </script>
</body>
</html>
